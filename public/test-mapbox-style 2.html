<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Test Mapbox Style Access</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-section { margin: 20px 0; padding: 15px; background: #f5f5f5; border-radius: 5px; }
        .result { margin-top: 10px; padding: 10px; border-radius: 3px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        pre { background: white; padding: 10px; border-radius: 3px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>Mapbox Style Access Test</h1>
    
    <div class="test-section">
        <h2>Test 1: Check Style API Access</h2>
        <button onclick="testStyleAPI()">Test Style API</button>
        <div id="style-result"></div>
    </div>
    
    <div class="test-section">
        <h2>Test 2: List Your Styles</h2>
        <button onclick="listStyles()">List My Styles</button>
        <div id="list-result"></div>
    </div>
    
    <div class="test-section">
        <h2>Test 3: Try Different Style URLs</h2>
        <button onclick="testAllFormats()">Test All URL Formats</button>
        <div id="formats-result"></div>
    </div>

    <script>
        const token = 'pk.eyJ1IjoidGhhYm9uZWwiLCJhIjoiY2x5enA4d21xMXd0MzJrcjNjajdnOGh2NCJ9.LQJOJPSIo1rj3m6UQDkBGA';
        const username = 'thabonel';
        const styleId = 'cm5ddi89k002301s552zx2fyc';
        
        async function testStyleAPI() {
            const resultDiv = document.getElementById('style-result');
            resultDiv.innerHTML = '<div class="result">Testing...</div>';
            
            try {
                // Test direct API access
                const response = await fetch(`https://api.mapbox.com/styles/v1/${username}/${styleId}?access_token=${token}`);
                const data = await response.json();
                
                if (response.ok) {
                    resultDiv.innerHTML = `
                        <div class="result success">
                            ✅ Style API Access Successful!
                            <pre>${JSON.stringify(data, null, 2)}</pre>
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <div class="result error">
                            ❌ Error: ${response.status} ${response.statusText}
                            <pre>${JSON.stringify(data, null, 2)}</pre>
                        </div>
                    `;
                }
            } catch (error) {
                resultDiv.innerHTML = `<div class="result error">❌ Error: ${error.message}</div>`;
            }
        }
        
        async function listStyles() {
            const resultDiv = document.getElementById('list-result');
            resultDiv.innerHTML = '<div class="result">Loading...</div>';
            
            try {
                const response = await fetch(`https://api.mapbox.com/styles/v1/${username}?access_token=${token}`);
                const styles = await response.json();
                
                if (response.ok) {
                    const styleList = styles.map(s => `
                        <li>
                            <strong>${s.name}</strong> (${s.id})<br>
                            Created: ${new Date(s.created).toLocaleDateString()}<br>
                            Modified: ${new Date(s.modified).toLocaleDateString()}
                        </li>
                    `).join('');
                    
                    resultDiv.innerHTML = `
                        <div class="result success">
                            ✅ Found ${styles.length} styles:
                            <ul>${styleList}</ul>
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <div class="result error">
                            ❌ Error: ${response.status}
                            <pre>${JSON.stringify(styles, null, 2)}</pre>
                        </div>
                    `;
                }
            } catch (error) {
                resultDiv.innerHTML = `<div class="result error">❌ Error: ${error.message}</div>`;
            }
        }
        
        async function testAllFormats() {
            const resultDiv = document.getElementById('formats-result');
            const formats = [
                { name: 'Full Style ID', url: `mapbox://styles/thabonel/cm5ddi89k002301s552zx2fyc` },
                { name: 'Without prefix', url: `mapbox://styles/thabonel/australia-offroad-89gicc` },
                { name: 'API URL', url: `https://api.mapbox.com/styles/v1/thabonel/cm5ddi89k002301s552zx2fyc` }
            ];
            
            let results = '<h3>Testing different URL formats:</h3>';
            
            for (const format of formats) {
                results += `<div class="result"><strong>${format.name}:</strong> ${format.url}</div>`;
            }
            
            resultDiv.innerHTML = results;
        }
    </script>
</body>
</html>