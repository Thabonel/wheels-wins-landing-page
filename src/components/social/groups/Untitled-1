// Add this import at the top with your other imports
import { AnimationErrorBoundary } from './components/common/AnimationErrorBoundary';

// Then wrap your RouteTransition in the App component:
function App() {
  // ... existing code ...

  return (
    <Router>
      <AuthProvider>
        <RegionProvider>
          <OfflineProvider>
            <ExpensesProvider>
              <WheelsProvider>
                <PamIntegrationProvider>
                  <AppErrorBoundary>
                    <PAMErrorBoundary>
                      <StagingBanner />
                      <Layout>
                        <ScrollToTop />
                        <div className="route-container">
                          {/* Add AnimationErrorBoundary wrapper */}
                          <AnimationErrorBoundary
                            fallback={
                              <div className="min-h-screen">
                                {/* Fallback content without animations */}
                                <Routes>
                                  <Route path="/" element={<Index />} />
                                  <Route path="/wheels" element={<ProtectedRoute><Wheels /></ProtectedRoute>} />
                                  <Route path="/you" element={<ProtectedRoute><You /></ProtectedRoute>} />
                                  <Route path="/wins" element={<ProtectedRoute><Wins /></ProtectedRoute>} />
                                  <Route path="/social" element={<ProtectedRoute><Social /></ProtectedRoute>} />
                                  <Route path="/shop" element={<ProtectedRoute><Shop /></ProtectedRoute>} />
                                  <Route path="/profile" element={<ProtectedRoute><Profile /></ProtectedRoute>} />
                                  <Route path="/login" element={<Login />} />
                                  <Route path="/signup" element={<Signup />} />
                                  <Route path="/onboarding" element={<ProtectedRoute><Onboarding /></ProtectedRoute>} />
                                  <Route path="/video-editor" element={
                                    <ProtectedRoute>
                                      <Suspense fallback={<div className="flex items-center justify-center h-64">Loading Video Editor...</div>}>
                                        <VideoEditor />
                                      </Suspense>
                                    </ProtectedRoute>
                                  } />
                                  <Route path="/admin" element={
                                    <AdminProtection>
                                      <Suspense fallback={<div className="flex items-center justify-center h-64">Loading Admin Dashboard...</div>}>
                                        <AdminDashboard />
                                      </Suspense>
                                    </AdminProtection>
                                  } />
                                  <Route path="/terms" element={<TermsOfService />} />
                                  <Route path="/privacy" element={<PrivacyPolicy />} />
                                  <Route path="/cookies" element={<CookiePolicy />} />
                                  <Route path="*" element={<div className="container p-8 text-center"><h1 className="text-2xl font-bold mb-4">404 - Page Not Found</h1><p>The page you're looking for doesn't exist.</p></div>} />
                                </Routes>
                              </div>
                            }
                          >
                            <RouteTransition>
                              <Routes>
                                {/* ... all your existing routes ... */}
                              </Routes>
                            </RouteTransition>
                          </AnimationErrorBoundary>
                        </div>
                      </Layout>
                    </PAMErrorBoundary>
                  </AppErrorBoundary>
                </PamIntegrationProvider>
              </WheelsProvider>
            </ExpensesProvider>
          </OfflineProvider>
        </RegionProvider>
      </AuthProvider>
    </Router>
  );
}